# Tools: Agent2Agent (A2A)

The `a2a` tool lets your Lectic interlocutor call a remote agent that
implements the Agent2Agent (A2A) protocol.

This is useful for:

- Testing the built-in `lectic a2a` server
- Delegating work to an external agent process

## Configuration

You configure an A2A tool by providing the base URL for the agent.

If your agent card is served at:

- `http://HOST:PORT/agents/<id>/.well-known/agent-card.json`

then set the tool URL to:

- `http://HOST:PORT/agents/<id>`

Example:

```yaml
tools:
  - name: remote_agent
    a2a: http://127.0.0.1:41240/agents/assistant
```

Optional settings:

- `stream`: prefer streaming (`message/sendStream`). Defaults to `true`.
- `headers`: extra HTTP headers to attach to every A2A request.
  - Header values support `file:` and `exec:` sources (same as MCP).
  - Avoid hardcoding secrets directly in YAML.

Example (bearer token loaded from an external command):

```yaml
tools:
  - name: prod_agent
    a2a: https://example.com/agents/assistant
    headers:
      Authorization: exec:bash -lc 'echo "Bearer $(pass a2a/token)"'
```

## Tool call parameters

The tool exposes these parameters:

- `op` (required): operation mode.
  - `sendMsg`: send user text via `message/send` (or `message/sendStream`).
  - `getTask`: poll a long-running task via `tasks/get`.
- `text` (required for `op=sendMsg`): user text to send to the agent.
- `contextId` (optional): A2A context id to continue a conversation.
- `taskId`:
  - required for `op=getTask`
  - optional for `op=sendMsg` (some agents may attach messages to a task)
- `stream` (optional): override streaming for `op=sendMsg`.

## Output format

The tool returns:

1. `text/plain`: the agent response text
2. 0 or more additional results extracted from A2A message parts and
   artifact updates:
   - `application/pdf`, `image/*`, etc. are returned as `data:` URLs when
     provided as bytes, or as a normal URL when provided as a URI.
   - `application/json` results are emitted for `data` parts.
3. `application/json`: call metadata

The metadata includes:

- `contextId`, `taskId`: identifiers you can reuse
- `agent`: the agent name from its agent card
- `baseUrl`, `streaming`: call metadata
